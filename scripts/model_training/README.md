# Model training
This directory contains the scripts used to perform both training rounds of the **brain clock**. Afterwards, the pipeline obtains performance metrics based on:
- 10-fold cross validation.
- Leaving out of the training set 1/3 of the healthy samples.
- External validation set (brainSeq Phase 1).
Finally, it predicts ages in individuals affected by neurodegeneration, and computes several statistic tests that show that these individuals have a significantly higher transcriptional age than their healthy counterparts.

1. **First training round**
Fits the model on the full SVA-adjusted matrix generated by `launch_preproc_pipe.sh`, in the [**preprocessing**](../preprocessing) module.

**To run**:
```bash
sbatch fitModel_first_round.sh
```
2. **Second training round**
Fits the model on the SVA-adjusted matrix generated by `launch_preproc_pipe_filtsigngenes.sh`, also in the [**preprocessing**](../preprocessing) module.This matrix was filtered prior to the preprocessing to contain only the genes  present in the model generated by `fitModel_first_round.sh`.

**To run**:
```bash
sbatch fitModel_second_round.sh
```
## Outputs
The results of the training pipelines will be written in:
- `./results/models/first_round/` for the first training round.
- `./results/models/second_round/` for the second training round.
Each output directory contains:
- Diagnostic plots.
- Performance metrics.
- Model coefficient file: `modFuncsAlpha1_coefs.csv`.
- Trained h2o model object stored in the `modFuncsAlpha1/` directory.
