# Model training
This directory contains the scripts that were used for performing both training rounds of the brain clock. After that, obtains performance metrics based on 10-fold cross validation and on leaving out of the training set 1/3 of the healthy samples. Finally, it predicts ages in individuals affected by neurodegeneration, and computes several statistic tests that show that these individuals hace a significantly higher transcriptional age than their healthy counterparts.
1. **First training round**
Fits the model on the whole SVA-adjusted matrix generated by `launch_preproc_pipe.sh`, in the [**preprocessing**](./scripts/preprocessing) module. For performing this step run:
```bash
sbatch fitModel_first_round.sh
```
2. **Second training round**
Fits the model on the SVA-adjusted matrix generated by `launch_preproc_pipe_filtsigngenes.sh`, in the [**preprocessing**](./scripts/preprocessing) module.This matrix was filtered prior to the preprocessing to contain only the genes  present in the model generated by `fitModel_first_round.sh`. For performing this step run:
```bash
sbatch fitModel_second_round.sh
```
## Outputs
The results of the two training pipelines will be written in `./results/models/first_round/` and `./results/models/second_round/`, for first and second training rounds, respectively. The outputs consist in several plots, files with the performance metrics, a csv file with the model's coefficients (`modFuncsAlpha1_coefs.csv`) and the h2o model object, within the directory `modFuncsAlpha1/`.
